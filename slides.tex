\input{header_slides.tex}

\begin{document}

\title[Agent-based modeling city networks]{An agent-based model for city networks based on interactions between firms}
\author[Raimbault \and Zdanowska]{J.~Raimbault$^{1,2,3\ast}$ \and N. Zdanowska$^{1,3}$\\\medskip
$^{\ast}$\texttt{j.raimbault@ucl.ac.uk}
}

\institute[UCL]{$^{1}$CASA, UCL\\
$^{2}$UPS CNRS 3611 Complex Systems Institute Paris\\
$^{3}$UMR CNRS 8504 G{\'e}ographie-cit{\'e}s
}


\date[2nd October 2019]{CCS 2019\\
Satellite Simulation models\\
October 2nd 2019
}

\frame{\maketitle}

\section{Introduction}


\sframe{Urban firm networks}{


General framework:

\begin{itemize}
    \item Cities as maximisation of socio-economic interactions 
    % que veux tu dire par maximisation ? je mettrais plutot "foster socio-eco"
    \item Network economies \cite{sassen1991global} \cite{castells1996information}
    \item World city network driven by interactions between firms \cite{taylor2001specification} \cite{martinus2018global}
    \item Asymmetrical spatial interactions -- different relative position of cities
\end{itemize}

\bigskip

}


\sframe{An evolutionary approach to Urban Systems}{

\begin{itemize}
    \item Evolutionary Theory of Urban Systems \cite{pumain1997pour} \cite{pumain2006villes}
    \item Adaptive cycles and diffusion on innovation \cite{Hagerstrand1968Innovation}
    \item Path dependence \cite{martin2006path} \cite{pumain2012urban}
    \item Selection and emerging structures of systems % pas clair
    \item Evolutionary models for urban systems dynamics: \cite{favaro2011gibrat} \cite{cottineau2015growing} \cite{schmitt2015half} \cite{raimbault2018indirect} \cite{raimbault2018calibration}
\end{itemize}

}

\sframe{Firm linkages structuring urban systems}{

% examples de resultats pour l'Europe Centrale et Orientale




 \begin{center}
 \includegraphics[width=0.7\textwidth]{figures/Figure1.png}
 \end{center}
 
  \textit{Central and Eastern European cities within ownership links of firms in 2013}

}

% si besoin je peux rajouter d'autres exemples sur le UK ou carrement des trucs de Celine sur les reseaux de firmes
% oui ca serait cool des trucs a toi sur le UK

\sframe{Urban Firm linkages and geo-economic processes}{

Assumptions

\begin{itemize}
    \item Metropolisation vs. regionalisation effects
    \item Relationship local/global of multinational firm linkages 
    \item Specialisation-driven factors and drivers of innovation
    \item Macroeconomic exogenous chocs and resilience of urban systems 
\end{itemize}

\bigskip

How can we capture geographical and economic processes within urban networks of firms with a generative model? 

}
\sframe{Towards a generative model of urban firm networks}{

Towards a generative model of urban firm networks

% research question / objective
% 


}

\section{Model}

\sframe{Model rationale}{

$\rightarrow$ Cities are defined by their GDP and their profile regarding the proportion of firms in the different sectors. Links between cities are created in an iterative way, taking into account:

\medskip

    \begin{itemize}
        \item geographical proximity (distance or effective accessibility)
        \item geopolitical proximity (belonging to the same country or single market $\rightarrow$ application to Brexit)
        \item city size (economic size as GDP) 
        \item economic similarity (e.g. cosine distance between sector proximity as done in \cite{2019arXiv190505106C}
        \item previous linkages 
    \end{itemize}

% j'ai mis ca plus pour moi,enfin pour moi c'est plus clair pour la presentation
%  => oui c'est exactement ce quil fallait mettre !

}


\sframe{Formalization}{

Cities characterized by economic size $E_i$ (GDP) and economic structure $S_{ik}$ (probability distribution of firms within $K$ sectors)

\bigskip

Starting from an initial network, at each time step:
\begin{enumerate}
    \item Evolve city sizes $E_i(t+1) = f(E_j(t))$ with an interaction model (\cite{raimbault2018indirect} or \cite{cottineau2015growing})
    \item Add a fixed number of links randomly, following a probability function of sizes, sector proximity, and geographical and socio-cultural proximity
\end{enumerate}

}


\sframe{Formalization}{

Probability for a new link follows a generalized Cobb-Douglas function

\medskip

\[
     p_{ij} \propto \left(\frac{E_{i}}{E}\right)^{\gamma_F} \cdot \left(\frac{E_{j}}{E}\right)^{\gamma_T} \cdot \left(\frac{w_{ij}}{W}\right)^{\gamma_W} \cdot s\left(S_{ik},S_{jk}\right)^{\gamma_S} \cdot \exp \left(- \gamma_G \cdot d_{ij}\right) \cdot \exp \left(- \gamma_D \cdot g_{ij}\right)
\]

\medskip

where $E=\sum_k E_k$, $W = \sum_{i,j} w_{ij}$, $s$ is cosine similarity, $d_{ij}$ euclidian distance, and $g_{ij}$ socio-cultural distance

\medskip

\textbf{Model parameters: } $\gamma_F, \gamma_T, \gamma_W, \gamma_S, \gamma_D = \frac{1}{d_G}, \gamma_G = \frac{1}{d_G}$

}

\sframe{Model indicators}{

\textbf{Geographical indicators:}

\begin{itemize}
    \item Internationalisation (modularity of countries in the network)
    \item Metropolisation (correlation between weighted degree and city size)
    \item Regionalisation (correlation between length and flow of links, stratified by size of extremities)
    \item Specialisation (correlation between sector proximity and flow of links, stratified by size of extremities)
\end{itemize}

\bigskip

\textbf{Network and flows indicators:}

%  networkModularity, networkAvgCommunitySize, networkDegreeHierarchy, networkAvgDegree, networkDegreeEntropy, flowsHierarchy, flowsEntropy, rhoDegreeSize, rhoFlowDistancePos, rhoFlowDistance

\begin{itemize}
    \item Louvain modularity, community sizes
    \item Degree and flows distribution (average, hierarchy, entropy)
    \item Correlations (degree-size, flow-distance)
\end{itemize}

}

\sframe{Simulation on synthetic systems of cities}{

% la ou avant il faut surement expliquer que c'est pas totalement synthetique, que tu pars de X villes europeennes de plus de 50 000 habitants (pour les plus nuls comme moi)
% si c'est completement synthetiques, l'histoire des villes europeenes c'est pour avoir les ordres de grandeur de la hierarchie et du nombre de villes, mais c'est pas parametrise sur des vraies donnees - mais oui ca ca sera explique dans comment construire le systeme de ville synthetique.

% ok desolee je n'avais pas bien compris 
% javais mal explique ^-^
 
\justify
 
\textit{Following \cite{raimbault2018space}, geosimulation models must be studied within synthetic controllable urban contexts in order to (i) understand intrinsic behavior of the model and robust qualitative stylized facts; (ii) study the sensitivity to the spatial configuration}

\bigskip

Generation of a continent-scale urban system with stylized order of magnitude corresponding to Europe:

\medskip

\tiny

\begin{enumerate}
    \item Generate $N=700$ cities with size following a power law $E_i \= E_0 \cdot i^{-\alpha}$ with $E_0 \= 10^{11}$ and $\alpha=1.1$ (computed on Europe for GDP with cities larger than 50.000 inhabitants)
    \item Distribute them randomly in space (\cite{simini2019testing} vs \cite{banos2011christaller})
    \item Create countries with k-means clustering ($C \eq 30$)
    \item Distribute sectors such that (i) smaller cities are more specialized and (ii) larger cities are more knowledge-based, with a one dimensional axis to position sectors $1/K \ldots 1$ where the density $f\left(k\right)$ follows a log-normal with $\left(\mu,\sigma\right)$ such that $\sqrt{\Var f} = K/2$ for the largest, $\sqrt{\Var f} = 1/K$ for the smallest
\end{enumerate}

 
}

\section{Results}

\sframe{Implementation and experiments}{



\begin{itemize}
	\item Model implemented in NetLogo (good compromise interactivity / ergonomy), with fast data structures (matrix/table extensions)
	\item Integrated seamlessly into OpenMOLE \cite{reuillon2013openmole} for model exploration (NetLogoTask)
\end{itemize}

% for now no dynamics of cities

\begin{itemize}
	\item Current experiment: only network dynamics (short time scale)
	\item One-factor sampling with 100 repetitions to assess statistical properties
	\item Grid sampling with 20 repetitions for model behavior (2years 5month of computation)
\end{itemize}

}

\sframe{Simulation of urban networks}{
    
    % examples
    
    \centering
    
    \includegraphics[width=0.48\textwidth]{figures/ex_alleq-highgravity_seed-12102_t1500.png}\hspace{0.1cm}
    \includegraphics[width=0.48\textwidth]{figures/ex_alleq-lowgravity_seed-12102_t1500.png}

	\medskip

	\textit{Networks at $t = 1500$, for default parameters values and high gravity (left) and low gravity (right)}

}


\sframe{Statistical convergence}{

$\rightarrow$ Good convergence for most indicators: average sharpes ratios on a one-factor sampling above 5 (except for metropolization index $\simeq 1.5$)

% + histograms

\bigskip




}


\sframe{Interaction decay}{
    
    % One factor sampling results
    %  20190924_162740_ONEFACTOR_REPLICATIONS_SYNTHETIC_GRID
    
    \includegraphics[width=0.48\textwidth]{figures/internationalization-gravityDecay_errorbars.png}
    \includegraphics[width=0.48\textwidth]{figures/rhoDegreeSize-gravityDecay_errorbars.png}
}

\sframe{Sector proximity}{
    
    % One factor sampling results
    %  20190924_162740_ONEFACTOR_REPLICATIONS_SYNTHETIC_GRID
    
     \includegraphics[width=0.48\textwidth]{figures/internationalization-gammaSectors_errorbars.png}
    \includegraphics[width=0.48\textwidth]{figures/rhoDegreeSize-gammaSectors_errorbars.png}
    
    
}

\sframe{Grid exploration}{

    \centering

    \includegraphics[width=\textwidth]{figures/internationalization_countryGravityDecay200_gammaDestination0_facetwrapgammaOrigin_colorgammaSectors.png}
}

\sframe{Grid exploration}{

    \centering

    \includegraphics[width=\textwidth]{figures/networkAvgCommunitySize_countryGravityDecay2100_gammaDestination0_facetwrapgammaOrigin_colorgammaSectors.png}
}

\sframe{Grid exploration}{

    \centering

    \includegraphics[width=\textwidth]{figures/rhoFlowDistance_countryGravityDecay2100_gammaDestination2_facetwrapgammaOrigin_colorgammaSectors.png}
}


% other experiments ? PSE on correlations ?




\section{Discussion}

% - future work etc (classical discussion)
% - on the role of model exploration and simulation to gain knowledge from the model

% further comparing with real data?

\sframe{On the role of model exploration}{

}


\sframe{Discussion}{

\textbf{Practical application}



\textbf{Developments}


}


\sframe{Conclusion}{

$\rightarrow$ A simulation model to understand processes of network emergence

$\rightarrow$ 


\bigskip
\bigskip


\textbf{Open repository for model and results at}

\texttt{https://github.com/JusteRaimbault/ABMCitiesFirms}

\textbf{Simulation data at}

\texttt{}% dataverse

\bigskip

\textbf{Acknowledgments}: thanks to the \textit{European Grid Infrastructure} for access to the infrastructure.


}



\sframe{Reserve slides}{

\centering

\Large

\textbf{Reserve Slides}

}



%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[allowframebreaks]
\frametitle{References}
\bibliographystyle{apalike}
\bibliography{biblio}
\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%







\end{document}

